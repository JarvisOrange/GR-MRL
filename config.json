{
 
    "debug": 1,
    "stage": 4,
    "exp_tag": "raw",
    "device": "cuda:0",
    "seed": 42,

    "dataset_src_trg": "B-L-C_S",

    "flag":  {
        "pretrain": {
                "batch_size": 256, 
                "epoch": 1000,
                "lr" : 5e-6,
                "weight_decay": 1e-2,
                "shuffle": false,
                "train_val_test":[0.8, 0.2],
                "patience":5
        },

        "source_train": {
            "batch_size": 8,
            "epoch": 1,
            "lr": 5e-5,
            "weight_decay": 5e-2
        },

        "target_train":{
            "batch_size": 8,
            "epoch": 3,
            "lr": 1e-5,
            "weight_decay": 1e-2
        },

         "test":{
            "batch_size": 128
        },

        "time_cluster":{
            "batch_size": 8192
        },

        "road_cluster":{
            "batch_size": 8192
        },

        "rag":{
            "batch_size": 4096
        }
    },

    "dataset_info": {
        "L":{
            "nodes": 207,
            "edges": 1722,
            "interval": 5,
            "time_step": 34272,
            "mean": 58.2749,
            "std": 13.128,
            "start_time": "2017-05-01 00:00:00",
            "end_time": "2017-06-30 24:00:00"
        },
        "B":{
            "nodes": 325,
            "edges": 2694,
            "interval": 5,
            "time_step": 52116,
            "mean": 61.7768,
            "std": 9.2852,
            "start_time": "2017-01-01 00:00:00",
            "end_time": "2017-06-30 24:00:00"
        },
        "C":{
            "nodes": 524,
            "edges": 1120,
            "interval": 10,
            "time_step": 17280,
            "mean": 29.0235,
            "std":9.662,
            "start_time": "2018-01-01 00:00:00",
            "end_time": "2018-04-30 24:00:00"
        },
        "S":{
            "nodes": 627,
            "edges": 4845,
            "interval": 10,
            "time_step": 17280,
            "mean": 31.0092,
            "std":10.9694,
            "start_time": "2018-01-01 00:00:00",
            "end_time": "2018-04-30 24:00:00"
        }
    },


    "laplacian_dim": 64,

    
    "time_cluster_k": 16,

    "road_cluster_k": 4, 

    "retrieve_k": 1,

    "his_num": 288, 
    "pre_num": 12, 

    "target_day": 3,


    "TSFormer": {
        "patch_size":12,
        "in_channel":1,

        "out_channel":128,

        "dropout":0.1,
        "window_size": 288,
        "mask_size":24,
        "mask_ratio":0.75,
        "n_layer":4
    },

    "GR_MRL": {
        "expert_dim": 64,
        "max_length": 128
    },

    "LLM_path": "./LLM/glm-4-9b",

    "lora_method": "stmoelora",

    "lora_rank": 32,
    "lora_dropout": 0.1,
    "lora_alpha": 32,

    "target_modules": ["query_key_value"],
    "modules_to_save": ["embed_tokens", "lm_head", "mapping_layer", "output_layer"],

    "expert_top_k": 2,

    "drop_last": true,

    "validate_epoch": 10,
    "patience": 5,
    "lr": 1e-5,
    "dropout": 0.2,
    "batch_size": 32
}
