import os
import torch
from GR_MRL import GR_MRL
from config import cfg
from utils import kmeans_pytorch

def time_cluster(dataset_src, logger=None):
    device = cfg['device']

    path = './Save/time_patch_embed/' + dataset_src + '/emb.pt'

    time_patch_pool = torch.load(path).to(device)

    center, center_label = kmeans_pytorch(
        X=time_patch_pool , num_clusters=cfg['time_cluster_k'])
    
    torch.save(center,'./Save/pattern/{}/{}_c.pt'.format(dataset_src, cfg['time_cluster_k']))
    torch.save(center_label,'./Save/pattern/{}/{}_cl.pt'.format(dataset_src, cfg['time_cluster_k']))